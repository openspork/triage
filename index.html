<html>

<head>
    <title>Triage</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function(){

        $(".update").change(function(){
            var sum = 0

            var vip = ($("#vip").val() === 'true')
            var affected = $("#affected").val()
            var size = $("#size").val()
            var productivity = ($("#productivity").val() === 'true')
            var bizfunc = ($("#bizfunc").val() === 'true')
            var workaround = ($("#workaround").val() === 'true')

            percent = affected / size

            if (percent >= .1 && percent <= .3) {
                if (sum < 20) {
                    var additional = 20 - sum
                    sum += additional
                }
                else {
                    sum += 10
                }
            }
            else if (percent > .3) {
                if (sum < 30) {
                    var additional = 40 - sum
                    sum += additional
                }
                else {
                    sum += 10
                }
            }

            if (productivity) {
                if (sum < 20) {
                    var additional = 20 - sum
                    sum += additional
                }
                else {
                    sum += 10
                }
            }

            if (workaround) { sum -= 10 }

            if (bizfunc) {
                if (sum < 30) {
                    var additional = 30 - sum
                    sum += additional
                }
                else {
                    sum += 10
                }
            }

            if (vip) {
                if (sum < 30) {
                    var additional = 30 - sum
                    sum += additional
                }
                else {
                    sum += 10
                }
            }

            if (sum < 20) {
                $("body").css("background-color", "blue")
                $("body").css("color", "white")
                $("#resultval").text("Priority 4, your score is: " + sum)
            }
            if (sum >= 20 && sum < 30) {
                $("body").css("background-color", "yellow")
                $("body").css("color", "black")
                $("#resultval").text("Priority 3, your score is: " + sum)
            }
            if (sum >= 30 && sum < 40) {
                $("body").css("background-color", "orange")
                $("body").css("color", "black")
                $("#resultval").text("Priority 2, your score is: " + sum)
            }
            if (sum >= 40 ) {
                $("body").css("background-color", "red")
                $("body").css("color", "white")
                $("#resultval").text("Priority 1, your score is: " + sum)
            }

        });
    });

    </script>
</head>

<body>
    <div id="checklist">
        Is the submitting user a VIP?
        <select name="vip" id="vip" class="update">
            <option value="false">No</option>
            <option value="true">Yes</option>
        </select>
        <br><br>
        How many users are there at the company?
        <input type="number" name="size" id="size" class="update"></input>
        <br><br>
        How many users are affected?
        <input type="number" name="affected" id="affected" class="update"></input>
        <br><br>
        Is there an issue currently impacting productivity?
        <select name="productivity" id="productivity" class="update">
            <option value="false">No</option>
            <option value="true">Yes</option>
        </select>
        <br><br>
        Is a critical business function unable to be performed?
        <select name="bizfunc" id="bizfunc" class="update">
            <option value="false">No</option>
            <option value="true">Yes</option>
        </select>
        <br><br>
        Is a workaround available:
        <select name="workaround" id="workaround" class="update" data-weight=-7>
            <option value="false">No</option>
            <option value="true">Yes</option>
        </select>
    </div>
    <div id="result">
        <p id="resultval"></p>
    </div>
</body>

</html>